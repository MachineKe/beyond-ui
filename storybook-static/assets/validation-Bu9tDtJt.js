import{c as y}from"./createLucideIcon-C3m4BMJg.js";import{j as T}from"./cn-BIubIUvQ.js";import{r as h}from"./index-l2PZgWEW.js";import{o as S,b as A,s as f}from"./schemas-Eps0FZeq.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L=y("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b=y("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/*! js-cookie v3.0.5 | MIT */function g(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)e[i]=r[i]}return e}var R={read:function(e){return e[0]==='"'&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}};function E(e,t){function r(o,a,s){if(!(typeof document>"u")){s=g({},t,s),typeof s.expires=="number"&&(s.expires=new Date(Date.now()+s.expires*864e5)),s.expires&&(s.expires=s.expires.toUTCString()),o=encodeURIComponent(o).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var c="";for(var l in s)s[l]&&(c+="; "+l,s[l]!==!0&&(c+="="+s[l].split(";")[0]));return document.cookie=o+"="+e.write(a,o)+c}}function i(o){if(!(typeof document>"u"||arguments.length&&!o)){for(var a=document.cookie?document.cookie.split("; "):[],s={},c=0;c<a.length;c++){var l=a[c].split("="),d=l.slice(1).join("=");try{var n=decodeURIComponent(l[0]);if(s[n]=e.read(d,n),o===n)break}catch{}}return o?s[o]:s}}return Object.create({set:r,get:i,remove:function(o,a){r(o,"",g({},a,{expires:-1}))},withAttributes:function(o){return E(this.converter,g({},this.attributes,o))},withConverter:function(o){return E(g({},this.converter,o),this.attributes)}},{attributes:{value:Object.freeze(t)},converter:{value:Object.freeze(e)}})}var u=E(R,{path:"/"});class v{constructor(){this.TOKEN_KEY="auth_token",this.REFRESH_TOKEN_KEY="refresh_token",this.USER_KEY="auth_user"}async login(t){if(await new Promise(r=>setTimeout(r,1e3)),t.email==="admin@example.com"&&t.password==="Password123!"){const r={id:"1",email:t.email,name:"John Doe",role:"admin",avatar:"https://images.pexels.com/photos/774909/pexels-photo-774909.jpeg?auto=compress&cs=tinysrgb&w=64",createdAt:new Date().toISOString(),lastLogin:new Date().toISOString()},i="mock_jwt_token_"+Date.now(),o="mock_refresh_token_"+Date.now(),a={expires:t.rememberMe?30:void 0,secure:!0,sameSite:"strict"};return u.set(this.TOKEN_KEY,i,a),u.set(this.REFRESH_TOKEN_KEY,o,a),localStorage.setItem(this.USER_KEY,JSON.stringify(r)),{user:r,token:i,refreshToken:o}}throw new Error("Invalid email or password")}async signup(t){if(await new Promise(s=>setTimeout(s,1500)),t.email==="existing@example.com")throw new Error("An account with this email already exists");const r={id:Date.now().toString(),email:t.email,name:t.name,role:"user",createdAt:new Date().toISOString()},i="mock_jwt_token_"+Date.now(),o="mock_refresh_token_"+Date.now(),a={expires:7,secure:!0,sameSite:"strict"};return u.set(this.TOKEN_KEY,i,a),u.set(this.REFRESH_TOKEN_KEY,o,a),localStorage.setItem(this.USER_KEY,JSON.stringify(r)),{user:r,token:i,refreshToken:o}}logout(){u.remove(this.TOKEN_KEY),u.remove(this.REFRESH_TOKEN_KEY),localStorage.removeItem(this.USER_KEY)}getCurrentUser(){try{const t=localStorage.getItem(this.USER_KEY);return t?JSON.parse(t):null}catch{return null}}getToken(){return u.get(this.TOKEN_KEY)||null}async refreshToken(){if(!u.get(this.REFRESH_TOKEN_KEY))throw new Error("No refresh token available");await new Promise(i=>setTimeout(i,500));const r="mock_jwt_token_refreshed_"+Date.now();return u.set(this.TOKEN_KEY,r,{expires:1,secure:!0,sameSite:"strict"}),r}isAuthenticated(){const t=this.getToken(),r=this.getCurrentUser();return!!(t&&r)}}const p=new v,x=(e,t)=>{switch(t.type){case"AUTH_START":return{...e,isLoading:!0,error:null};case"AUTH_SUCCESS":return{...e,user:t.payload,isAuthenticated:!0,isLoading:!1,error:null};case"AUTH_ERROR":return{...e,user:null,isAuthenticated:!1,isLoading:!1,error:t.payload};case"AUTH_LOGOUT":return{...e,user:null,isAuthenticated:!1,isLoading:!1,error:null};case"CLEAR_ERROR":return{...e,error:null};case"SET_LOADING":return{...e,isLoading:t.payload};default:return e}},O={user:null,isAuthenticated:!1,isLoading:!0,error:null},k=h.createContext(void 0),_=({children:e})=>{const[t,r]=h.useReducer(x,O);h.useEffect(()=>{(()=>{try{const n=p.getCurrentUser(),m=p.isAuthenticated();r(n&&m?{type:"AUTH_SUCCESS",payload:n}:{type:"SET_LOADING",payload:!1})}catch(n){console.error("Failed to initialize auth:",n),r({type:"SET_LOADING",payload:!1})}})()},[]);const i=h.useCallback(async d=>{r({type:"AUTH_START"});try{const{user:n}=await p.login(d);r({type:"AUTH_SUCCESS",payload:n})}catch(n){const m=n instanceof Error?n.message:"Login failed";throw r({type:"AUTH_ERROR",payload:m}),n}},[]),o=h.useCallback(async d=>{r({type:"AUTH_START"});try{const{user:n}=await p.signup(d);r({type:"AUTH_SUCCESS",payload:n})}catch(n){const m=n instanceof Error?n.message:"Signup failed";throw r({type:"AUTH_ERROR",payload:m}),n}},[]),a=h.useCallback(()=>{p.logout(),r({type:"AUTH_LOGOUT"})},[]),s=h.useCallback(()=>{r({type:"CLEAR_ERROR"})},[]),c=h.useCallback(async()=>{try{await p.refreshToken()}catch(d){console.error("Token refresh failed:",d),a()}},[a]),l={user:t.user,isAuthenticated:t.isAuthenticated,isLoading:t.isLoading,error:t.error,login:i,signup:o,logout:a,clearError:s,refreshToken:c};return T.jsx(k.Provider,{value:l,children:e})},w=()=>{const e=h.useContext(k);if(e===void 0)throw new Error("useAuth must be used within an AuthProvider");return e};try{_.displayName="AuthProvider",_.__docgenInfo={description:"AuthProvider component that manages authentication state",displayName:"AuthProvider",props:{}}}catch{}try{w.displayName="useAuth",w.__docgenInfo={description:"Hook to use authentication context",displayName:"useAuth",props:{}}}catch{}const C=f().min(8,"Password must be at least 8 characters").regex(/[A-Z]/,"Password must contain at least one uppercase letter").regex(/[a-z]/,"Password must contain at least one lowercase letter").regex(/[0-9]/,"Password must contain at least one number").regex(/[^A-Za-z0-9]/,"Password must contain at least one special character"),I=S({email:f().min(1,"Email is required").email("Please enter a valid email address"),password:f().min(1,"Password is required"),rememberMe:A().optional()}),H=S({name:f().min(2,"Name must be at least 2 characters").max(50,"Name must be less than 50 characters").regex(/^[a-zA-Z\s]+$/,"Name can only contain letters and spaces"),email:f().min(1,"Email is required").email("Please enter a valid email address"),password:C,confirmPassword:f().min(1,"Please confirm your password"),acceptTerms:A().refine(e=>e===!0,"You must accept the terms of service")}).refine(e=>e.password===e.confirmPassword,{message:"Passwords do not match",path:["confirmPassword"]}),j=e=>{let t=0;e.length>=8&&(t+=1),e.length>=12&&(t+=1),/[A-Z]/.test(e)&&(t+=1),/[a-z]/.test(e)&&(t+=1),/[0-9]/.test(e)&&(t+=1),/[^A-Za-z0-9]/.test(e)&&(t+=1);const r={0:{label:"Very Weak",color:"danger"},1:{label:"Weak",color:"danger"},2:{label:"Fair",color:"warning"},3:{label:"Good",color:"warning"},4:{label:"Strong",color:"success"},5:{label:"Very Strong",color:"success"},6:{label:"Excellent",color:"success"}}[Math.min(t,6)]||{label:"Very Weak",color:"danger"};return{score:t,...r}};export{L as E,b as L,j as c,I as l,H as s,w as u};
